## Week 7: Factory Model and Exception

经济管理中通常有大量的数据以excel格式存在，如本次作业提供的中国各省长周期CO2排放数据（资源/data/co2_demo.zip)。数据格式如下：所有数据按年份存储在不同的文件中,Province_sectoral_CO2_emissions_20xx.xlsx，其中20xx为年份。单个excel文件中，"sum"数据页给出了各省的总$CO_2$排放量以及来源明细，其余以省命名的数据页则给出了各省不同行业不同来源的$CO_2$排放量。



1. 至少实现一个数据分析类，以提供数据的读取及基本的时间（如某区域某类型排放随时间的变化）和空间分析（某一年全国排放的空间分布态势）方法。

2. 至少实现一个数据可视化类，以提供上述时空分析结果的可视化，如以曲线、饼等形式对结果进行呈现。

3. 由于数据中包含空值等异常值，在进行数据分析以及可视化前需要检查数据。因此需要实现NotNumError类，继承ValueError，并加入新属性year，province，industry，type，对数据进行检测，若取到的一列数据中包含nan，则抛出该异常，并提供异常相关的年份，省份，工业和排放类型等信息。在此基础上，利用try except捕获该异常，打印异常信息，并对应位置的数据进行适当的填充。

4. 由于部分省份排放总量数据为0，要求在计算比例时进行检验，若检验发现总量为0，则抛出ZeroDivisionError，并打印对应的行名等信息。

5. （附加）按时间分析时，注意观察不同区域随时间排放量的变化，是否存在一些明显的趋势，以及趋势的空间差异，并思考这些趋势及差异的管理意义与政策启发。


提示：可以使用openpyxl来读取excel文件。